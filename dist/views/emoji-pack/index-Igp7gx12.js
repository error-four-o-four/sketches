var qt=Object.defineProperty;var zt=(b,p,d)=>p in b?qt(b,p,{enumerable:!0,configurable:!0,writable:!0,value:d}):b[p]=d;var o=(b,p,d)=>zt(b,typeof p!="symbol"?p+"":p,d);(function(){"use strict";var b=document.createElement("style");b.textContent=`.tab-component .tab-link-wrap{display:inline-flex}.tab-component .tab-link-wrap>div{cursor:pointer}.tab-component .tab-item-wrap>div{display:none;transition:opacity .2s}.tab-component .tab-item-wrap>div.selected{display:block;opacity:1}.tab-component .tab-item-wrap>div.hidden{opacity:0}.button-component{display:inline-block}.button-component input{display:none}.button-component label{cursor:pointer}.radios-component{display:inline-block}.ul-component{list-style:none;padding:0}.ul-component li{position:relative;opacity:1;cursor:pointer}.ul-component li.hidden{opacity:0}.ul-component:empty:after{font-size:.75rem}.ul-component.removable li:after{content:"âŒ";position:absolute;font-size:.75rem;top:-.375rem;right:-.5rem;opacity:0;transition:opacity .2s,top .2s}.ul-component.removable li.removable:after{top:-.5rem;opacity:1}.button-component{margin:0 .5rem .5rem 0}.button-component label{display:inline-block;position:relative;font-size:.75rem;font-weight:700;-webkit-user-select:none;user-select:none;padding:.25rem .5rem .25rem .25rem;border-radius:var(--border-radius);border:1px solid var(--clr-base-20);background-color:var(--clr-base-12);box-shadow:var(--box-shadow);transition:color .2s,background-color .2s,border-color}.button-component input:disabled+label{color:#666}.button-component input:not(:disabled)+label:hover{color:#ccc;border-color:var(--clr-base-25);background-color:var(--clr-base-15)}.button-component input:not(:disabled)+label:active{transition:none;border-color:var(--clr-base-30);background-color:var(--clr-base-20)}.button-component label:before{content:"";display:inline-block;width:1.5rem;height:1.5rem;margin:0 .5rem 0 0;vertical-align:middle;background-color:currentColor;-webkit-mask-image:var(--svg);mask-image:var(--svg);-webkit-mask-repeat:no-repeat;mask-repeat:no-repeat;-webkit-mask-size:100% 100%;mask-size:100% 100%}.button-component #toggle-play-pause+label{min-width:4rem}.button-component #toggle-play-pause[value=play]+label{--svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23000' d='M8 17.175V6.825q0-.425.3-.713t.7-.287q.125 0 .263.037t.262.113l8.15 5.175q.225.15.338.375t.112.475t-.112.475t-.338.375l-8.15 5.175q-.125.075-.262.113T9 18.175q-.4 0-.7-.288t-.3-.712'/%3E%3C/svg%3E")}.button-component #toggle-play-pause[value=pause]+label{--svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23000' d='M16 19q-.825 0-1.412-.587T14 17V7q0-.825.588-1.412T16 5t1.413.588T18 7v10q0 .825-.587 1.413T16 19m-8 0q-.825 0-1.412-.587T6 17V7q0-.825.588-1.412T8 5t1.413.588T10 7v10q0 .825-.587 1.413T8 19'/%3E%3C/svg%3E")}.button-component #button-refresh+label{--svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23000' d='M12 20q-3.35 0-5.675-2.325T4 12t2.325-5.675T12 4q1.725 0 3.3.712T18 6.75V5q0-.425.288-.712T19 4t.713.288T20 5v5q0 .425-.288.713T19 11h-5q-.425 0-.712-.288T13 10t.288-.712T14 9h3.2q-.8-1.4-2.187-2.2T12 6Q9.5 6 7.75 7.75T6 12t1.75 4.25T12 18q1.7 0 3.113-.862t2.187-2.313q.2-.35.563-.487t.737-.013q.4.125.575.525t-.025.75q-1.025 2-2.925 3.2T12 20'/%3E%3C/svg%3E")}.button-component #button-background+label{--svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23000' d='M12 22q-2.05 0-3.875-.788t-3.187-2.15t-2.15-3.187T2 12q0-2.075.813-3.9t2.2-3.175T8.25 2.788T12.2 2q2 0 3.775.688t3.113 1.9t2.125 2.875T22 11.05q0 2.875-1.75 4.413T16 17h-1.85q-.225 0-.312.125t-.088.275q0 .3.375.863t.375 1.287q0 1.25-.687 1.85T12 22m-5.5-9q.65 0 1.075-.425T8 11.5t-.425-1.075T6.5 10t-1.075.425T5 11.5t.425 1.075T6.5 13m3-4q.65 0 1.075-.425T11 7.5t-.425-1.075T9.5 6t-1.075.425T8 7.5t.425 1.075T9.5 9m5 0q.65 0 1.075-.425T16 7.5t-.425-1.075T14.5 6t-1.075.425T13 7.5t.425 1.075T14.5 9m3 4q.65 0 1.075-.425T19 11.5t-.425-1.075T17.5 10t-1.075.425T16 11.5t.425 1.075T17.5 13M12 20q.225 0 .363-.125t.137-.325q0-.35-.375-.825T11.75 17.3q0-1.05.725-1.675T14.25 15H16q1.65 0 2.825-.962T20 11.05q0-3.025-2.312-5.038T12.2 4Q8.8 4 6.4 6.325T4 12q0 3.325 2.338 5.663T12 20'/%3E%3C/svg%3E")}.button-component #button-shuffle+label{--svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 640 512'%3E%3Cpath fill='%23000' d='M592 192H473.26c12.69 29.59 7.12 65.2-17 89.32L320 417.58V464c0 26.51 21.49 48 48 48h224c26.51 0 48-21.49 48-48V240c0-26.51-21.49-48-48-48M480 376c-13.25 0-24-10.75-24-24c0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24m-46.37-186.7L258.7 14.37c-19.16-19.16-50.23-19.16-69.39 0L14.37 189.3c-19.16 19.16-19.16 50.23 0 69.39L189.3 433.63c19.16 19.16 50.23 19.16 69.39 0L433.63 258.7c19.16-19.17 19.16-50.24 0-69.4M96 248c-13.25 0-24-10.75-24-24c0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24m128 128c-13.25 0-24-10.75-24-24c0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24m0-128c-13.25 0-24-10.75-24-24c0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24m0-128c-13.25 0-24-10.75-24-24c0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24m128 128c-13.25 0-24-10.75-24-24c0-13.26 10.75-24 24-24s24 10.74 24 24c0 13.25-10.75 24-24 24'/%3E%3C/svg%3E")}.button-component #button-save+label{--svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23000' d='m17 17.2l-.9-.9q-.275-.275-.7-.275t-.7.275t-.275.7t.275.7l2.6 2.6q.3.3.7.3t.7-.3l2.6-2.6q.275-.275.275-.7t-.275-.7t-.7-.275t-.7.275l-.9.9v-3.175q0-.425-.288-.712T18 13.025t-.712.288t-.288.712zM15 22h6q.425 0 .713.288T22 23t-.288.713T21 24h-6q-.425 0-.712-.288T14 23t.288-.712T15 22m-9-2q-.825 0-1.412-.587T4 18V4q0-.825.588-1.412T6 2h6.175q.4 0 .763.15t.637.425l4.85 4.85q.275.275.425.638t.15.762v1.2q0 .425-.288.712t-.712.288t-.712-.288t-.288-.712V9h-3.5q-.625 0-1.062-.437T12 7.5V4H6v14h5q.425 0 .713.288T12 19t-.288.713T11 20zm0-2V4z'/%3E%3C/svg%3E")}.button-component #button-upload+label{--svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23000' d='M11 19h2v-4.175l1.6 1.6L16 15l-4-4l-4 4l1.425 1.4L11 14.825zm-5 3q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h8l6 6v12q0 .825-.587 1.413T18 22zm7-13V4H6v16h12V9zM6 4v5zv16z'/%3E%3C/svg%3E")}.button-component #radio-select+label{--svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23000' d='M6 22q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h7.175q.4 0 .763.15t.637.425l4.85 4.85q.275.275.425.638t.15.762V13q0 .425-.288.713T19 14t-.712-.288T18 13V9h-4q-.425 0-.712-.288T13 8V4H6v16h8q.425 0 .713.288T15 21t-.288.713T14 22zm13-2.575v1.225q0 .425-.288.713T18 21.65t-.712-.287T17 20.65V17q0-.425.288-.712T18 16h3.65q.425 0 .713.288t.287.712t-.287.713t-.713.287H20.4l2.25 2.25q.275.275.275.688t-.275.712q-.3.3-.712.3t-.713-.3zM6 20V4z'/%3E%3C/svg%3E")}.button-component #radio-remove+label{--svg: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%23000' d='M6 4v5zv16v-.238V20zm0 18q-.825 0-1.412-.587T4 20V4q0-.825.588-1.412T6 2h8l6 6v4.35q-.475-.175-.975-.262T18 12V9h-5V4H6v16h6.35q.2.575.5 1.075t.7.925zm9.9-.5l-1.4-1.4l2.1-2.1l-2.1-2.1l1.4-1.4l2.1 2.1l2.1-2.1l1.4 1.4l-2.075 2.1l2.075 2.1l-1.4 1.4l-2.1-2.075z'/%3E%3C/svg%3E")}.ul-component li{background-color:var(--clr-base-12)}.ul-component li:hover{background-color:var(--clr-base-20)}#sketch-controls .ul-component:empty:after{content:"Upload an image or pick an emoji from below ...";font-size:.75rem}#image-picker .ul-component:empty:after{content:"Nothing uploaded yet ..."}#sketch-controls .ul-component,#image-picker .ul-component{display:flex;flex-wrap:wrap;gap:.75rem;min-height:calc(2.5rem + 2px)}#sketch-controls .ul-component li,#image-picker .ul-component li{width:1.5rem;height:1.5rem;padding:.5rem;text-align:center;border-radius:var(--border-radius);border:1px solid var(--clr-base-20);background-color:var(--clr-base-12);box-shadow:var(--box-shadow);transition:background-color .2s,border-color .2s,opacity .2s,width .2s,padding-inline .2s}#sketch-controls .ul-component li:hover,#image-picker .ul-component li:hover{border-color:var(--clr-base-25);background-color:var(--clr-base-20)}#sketch-controls .ul-component li.removing,#image-picker .ul-component li.removing{overflow:hidden;width:0;margin:0 calc(-.375rem - 1px);padding-inline:0rem;border-color:transparent;background-color:transparent}#sketch-controls .ul-component img,#image-picker .ul-component img{max-width:100%;max-height:100%}.tab-component .tab-link-wrap{overflow-y:hidden;margin-bottom:-1.5px;padding:.5rem .75rem 0}.tab-component .tab-link{min-width:2.5rem;padding-bottom:.125rem;text-align:center;line-height:2rem;border:1px solid transparent;transition:margin-top .2s}.tab-component .tab-link:not(.selected):hover{margin-top:-2px}.tab-component .tab-link.selected{cursor:default;margin-top:-2px;border-top-left-radius:var(--border-radius);border-top-right-radius:var(--border-radius);border-top:1px solid var(--clr-base-20);border-left:1px solid var(--clr-base-20);border-right:1px solid var(--clr-base-20);background-color:var(--clr-base-12);box-shadow:var(--box-shadow)}.tab-component .tab-item-wrap{border-radius:var(--border-radius);border:1px solid var(--clr-base-20);background-color:var(--clr-base-12);box-shadow:var(--box-shadow)}.tab-component .tab-item .ul-component{display:grid;grid-template-columns:repeat(auto-fit,minmax(3rem,1fr));margin:0;padding:0;font-size:1.25rem}.tab-component .tab-item .ul-component li{-webkit-user-select:none;user-select:none;padding:.5rem;text-align:center;transition:background-color .2s}.tab-component .tab-item .ul-component li:active{transition:none;background-color:var(--clr-base-25)}
`,document.head.appendChild(b);function p(s){return s.replace(/[^a-z0-9]/gi,"_").slice(0,64)}function d(s,t){return!!s&&s instanceof t}function O(s,t){if(!s||!(s instanceof t)){const e=s?s.constructor.name:"null";throw new Error(`Expected element to be a ${t.name}, but was ${e}`)}}async function E(s){return new Promise(t=>setTimeout(t,s))}const L=["&#128512;","&#128514;","&#128515;","&#128516;","&#128517;","&#128518;","&#128521;","&#128522;","&#128525;","&#128536;","&#128539;","&#128540;","&#128541;","&#128543;","&#128547;","&#128566;","&#128577;","&#128578;","&#129321;","&#129326;","&#129402;","&#129488;","&#128124;","&#x1F607;","&#x1F608;","&#x1F47F;","&#x1F60B;","&#x1F60C;","&#x1F60E;","&#x1F610;","&#x1F611;","&#x1F612;","&#x1F613;","&#x1F616;","&#x1F617;","&#x1F61A;","&#x1F61E;","&#x1F620;","&#x1F621;","&#x1F622;","&#x1F624;","&#x1F625;","&#x1F626;","&#x1F627;","&#x1F628;","&#x1F62A;","&#x1F62B;","&#x1F62D;","&#x1F62E;","&#x1F62F;","&#x1F631;","&#x1F632;","&#x1F635;","&#x1F637;","&#x1F911;","&#x1F913;","&#x1F917;","&#x1F914;","&#x1F915;","&#x1F922;","&#x1F927;","&#x1F928;","&#x1F92A;","&#x1F92B;","&#x1F92F;","&#x1F975;","&#x1F976;","&#x1F921;","&#x1F920;","&#x1F916;","&#x1F480;","&#x1F9B4;","&#128169;","&#x1F638;","&#128571;","&#x1F639;","&#x1F63A;","&#x1F63C;","&#x1F63D;","&#x1F63E;","&#x1F63F;","&#x1F640;","&#128053;","&#128584;","&#128585;","&#128586;","&#128070;","&#128076;","&#128077;","&#128406;","&#129304;","&#129305;","&#x1F44A;","&#x1F44B;","&#x1F44E;","&#x1F44F;","&#x1F450;","&#x1F595;","&#x1F64C;","&#x1F64F;","&#x1F91A;","&#x1F91B;","&#x1F91C;","&#x1F91D;","&#x1F91E;","&#x1F91F;","&#x1F932;","&#x270A;","&#x270B;","&#x1F4AA;","&#x1F9B5;","&#x1F9B6;","&#128064;","&#x1F442;","&#x1F443;","&#x1F444;","&#x1F445;","&#x1F9E0;","&#x1F464;","&#x1F465;","&#x1F466;","&#x1F467;","&#x1F468;","&#x1F469;","&#x1F46A;","&#x1F46B;","&#x1F46C;","&#x1F46D;","&#x1F46E;","&#x1F46F;","&#x1F470;","&#127877;","&#x1F936;","&#x1F934;","&#x1F471;","&#x1F472;","&#x1F473;","&#x1F474;","&#x1F475;","&#x1F476;","&#x1F477;","&#x1F478;","&#x1F479;","&#x1F47A;","&#x1F47D;","&#x1F47E;","&#x1F481;","&#x1F482;","&#x1F483;","&#x1F484;","&#x1F485;","&#x1F935;","&#x1F486;","&#x1F487;","&#x1F9B7;","&#x1F9B8;","&#x1F9B9;","&#x1F57A;","&#x1F645;","&#x1F646;","&#x1F647;","&#x1F64B;","&#x1F64D;","&#x1F64E;","&#x1F926;","&#x1F930;","&#x1F931;","&#x1F937;","&#x1F938;","&#x1F939;","&#x1F93C;","&#x1F93D;","&#x1F93E;","&#x1F9D1;","&#x1F9D2;","&#x1F9D3;","&#x1F9D4;","&#x1F9D5;","&#x1F9D6;","&#x1F9D7;","&#x1F9D8;","&#x1F9D9;","&#x1F9DA;","&#x1F9DB;","&#x1F9DC;","&#x1F9DD;","&#x1F9DE;","&#x1F9DF;","&#128018;","&#x1F400;","&#x1F401;","&#x1F402;","&#x1F403;","&#x1F405;","&#x1F406;","&#x1F407;","&#x1F408;","&#x1F40A;","&#x1F40B;","&#x1F40C;","&#x1F40D;","&#x1F40E;","&#x1F40F;","&#x1F410;","&#x1F411;","&#x1F413;","&#x1F415;","&#x1F416;","&#x1F417;","&#x1F418;","&#x1F41B;","&#x1F41C;","&#x1F41D;","&#x1F41E;","&#x1F41F;","&#x1F420;","&#x1F421;","&#x1F422;","&#x1F424;","&#x1F426;","&#x1F427;","&#x1F428;","&#x1F429;","&#x1F42A;","&#x1F42B;","&#x1F42C;","&#x1F42D;","&#x1F42E;","&#x1F42F;","&#x1F430;","&#x1F431;","&#x1F433;","&#x1F434;","&#x1F436;","&#x1F437;","&#x1F438;","&#x1F439;","&#x1F43A;","&#x1F43B;","&#x1F43C;","&#x1F43D;","&#128020;","&#x1F980;","&#x1F983;","&#x1F984;","&#x1F985;","&#x1F987;","&#x1F988;","&#x1F989;","&#x1F98A;","&#x1F98D;","&#x1F98E;","&#x1F98F;","&#x1F990;","&#x1F991;","&#x1F992;","&#x1F993;","&#x1F994;","&#x1F995;","&#x1F996;","&#x1F998;","&#x1F999;","&#x1F99A;","&#x1F99B;","&#x1F99D;","&#x1F99E;","&#x1F99F;","&#x1F9A1;","&#x1F9A2;","&#x1f98c;","&#127747;","&#127775;","&#127776;","&#127794;","&#127855;","&#127873;","&#127876;","&#127879;","&#127880;","&#127884;","&#127935;","&#127936;","&#127938;","&#127942;","&#127944;","&#127945;","&#127952;","&#128026;","&#128096;","&#128145;","&#128147;","&#128148;","&#128149;","&#128150;","&#128151;","&#128152;","&#128153;","&#128154;","&#128155;","&#128156;","&#128157;","&#128158;","&#128159;","&#128165;","&#128196;","&#128203;","&#128209;","&#128213;","&#128215;","&#128216;","&#128217;","&#128221;","&#128241;","&#128276;","&#128293;","&#128420;","&#128680;","&#128757;","&#129331;","&#129351;","&#129352;","&#129353;","&#129358;","&#129419;","&#129440;","&#129505;","&#9917;","&#9918;","&#10060;","&#10062;","&#9989;","&#x1F004;","&#x1F0CF;","&#x1F17F;","&#x1F191;","&#x1F192;","&#x1F193;","&#x1F194;","&#x1F195;","&#x1F196;","&#x1F197;","&#x1F198;","&#x1F199;","&#x1F19A;","&#x1F300;","&#x1F301;","&#x1F302;","&#x1F304;","&#x1F305;","&#x1F306;","&#x1F307;","&#x1F308;","&#x1F309;","&#x1F30A;","&#x1F30B;","&#x1F30C;","&#x1F30D;","&#x1F30E;","&#x1F30F;","&#x1F310;","&#x1F311;","&#x1F312;","&#x1F313;","&#x1F314;","&#x1F315;","&#x1F316;","&#x1F317;","&#x1F318;","&#x1F31A;","&#x1F31B;","&#x1F31C;","&#x1F31D;","&#x1F32D;","&#x1F32E;","&#x1F32F;","&#x1F330;","&#x1F331;","&#x1F333;","&#x1F334;","&#x1F335;","&#x1F336;","&#x1F338;","&#x1F339;","&#x1F33B;","&#x1F33D;","&#x1F33E;","&#x1F33F;","&#x1F340;","&#x1F342;","&#x1F343;","&#x1F344;","&#x1F345;","&#x1F346;","&#x1F347;","&#x1F348;","&#x1F349;","&#x1F34A;","&#x1F34B;","&#x1F34C;","&#x1F34D;","&#x1F34E;","&#x1F34F;","&#x1F350;","&#x1F351;","&#x1F352;","&#x1F353;","&#x1F354;","&#x1F355;","&#x1F356;","&#x1F357;","&#x1F358;","&#x1F359;","&#x1F35A;","&#x1F35B;","&#x1F35C;","&#x1F35D;","&#x1F35E;","&#x1F360;","&#x1F361;","&#x1F362;","&#x1F363;","&#x1F364;","&#x1F365;","&#x1F366;","&#x1F367;","&#x1F368;","&#x1F369;","&#x1F36A;","&#x1F36B;","&#x1F36C;","&#x1F36E;","&#x1F370;","&#x1F371;","&#x1F372;","&#x1F373;","&#x1F374;","&#x1F375;","&#x1F376;","&#x1F377;","&#x1F378;","&#x1F379;","&#x1F37A;","&#x1F37B;","&#x1F37C;","&#x1F37F;","&#x1F382;","&#x1F389;","&#x1F38A;","&#x1F38B;","&#x1F38D;","&#x1F38E;","&#x1F38F;","&#x1F390;","&#x1F391;","&#x1F392;","&#x1F393;","&#x1F3A0;","&#x1F3A1;","&#x1F3A2;","&#x1F3A3;","&#x1F3A4;","&#x1F3A5;","&#x1F3A6;","&#x1F3A7;","&#x1F3A8;","&#x1F3A9;","&#x1F3AA;","&#x1F3AB;","&#x1F3AC;","&#x1F3AD;","&#x1F3AE;","&#x1F3AF;","&#x1F3B0;","&#x1F3B1;","&#x1F3B2;","&#x1F3B3;","&#x1F3B4;","&#x1F3B5;","&#x1F3B6;","&#x1F3B7;","&#x1F3B8;","&#x1F3B9;","&#x1F3BA;","&#x1F3BB;","&#x1F3BC;","&#x1F3BD;","&#x1F3BE;","&#x1F3C1;","&#x1F3C3;","&#x1F3C4;","&#x1F3C5;","&#x1F3C7;","&#x1F3CA;","&#x1F3CB;","&#x1F3CC;","&#x1F3CF;","&#x1F3D1;","&#x1F3D2;","&#x1F3D3;","&#x1F3E0;","&#x1F3E1;","&#x1F3E2;","&#x1F3E3;","&#x1F3E4;","&#x1F3E5;","&#x1F3E6;","&#x1F3E7;","&#x1F3E8;","&#x1F3E9;","&#x1F3EA;","&#x1F3EB;","&#x1F3EC;","&#x1F3ED;","&#x1F3EE;","&#x1F3EF;","&#x1F3F0;","&#x1F3F4;","&#x1F3F8;","&#x1F3F9;","&#x1F3FA;","&#x1F451;","&#x1F452;","&#x1F453;","&#x1F454;","&#x1F455;","&#x1F457;","&#x1F458;","&#x1F459;","&#x1F45A;","&#x1F45B;","&#x1F45C;","&#x1F45D;","&#x1F45E;","&#x1F45F;","&#x1F461;","&#x1F462;","&#x1F97E;","&#x1F97F;","&#x1F463;","&#x1F489;","&#x1F48A;","&#x1F48B;","&#x1F48C;","&#x1F48D;","&#x1F48E;","&#x1F48F;","&#x1F490;","&#x1F492;","&#x1F4A0;","&#x1F4A1;","&#x1F4A2;","&#x1F4A3;","&#x1F4A6;","&#x1F4A7;","&#x1F4A8;","&#x1F4AB;","&#x1F4AC;","&#x1F4AD;","&#x1F4AF;","&#x1F4B0;","&#x1F4B3;","&#x1F4B4;","&#x1F4B5;","&#x1F4B6;","&#x1F4B8;","&#x1F4BA;","&#x1F4BB;","&#x1F4BC;","&#x1F4BD;","&#x1F4BE;","&#x1F4BF;","&#x1F4C0;","&#x1F4C1;","&#x1F4C2;","&#x1F4C8;","&#x1F4C9;","&#x1F4CA;","&#x1F4CC;","&#x1F4CD;","&#x1F4CE;","&#x1F4CF;","&#x1F4D0;","&#x1F4D6;","&#x1F4DA;","&#x1F4DB;","&#x1F4DE;","&#x1F4E0;","&#x1F4E1;","&#x1F4E2;","&#x1F4E3;","&#x1F4E4;","&#x1F4E6;","&#x1F4E7;","&#x1F4E8;","&#x1F4E9;","&#x1F4EA;","&#x1F4EB;","&#x1F4ED;","&#x1F4EE;","&#x1F4EF;","&#x1F4F0;","&#x1F4F2;","&#x1F4F3;","&#x1F4F4;","&#x1F4F6;","&#x1F4F7;","&#x1F4F8;","&#x1F4F9;","&#x1F4FA;","&#x1F4FB;","&#x1F4FC;","&#x1F4FF;","&#x1F500;","&#x1F501;","&#x1F502;","&#x1F503;","&#x1F504;","&#x1F505;","&#x1F506;","&#x1F507;","&#x1F508;","&#x1F509;","&#x1F50A;","&#x1F50B;","&#x1F50C;","&#x1F50D;","&#x1F50E;","&#x1F50F;","&#x1F510;","&#x1F511;","&#x1F512;","&#x1F513;","&#x1F515;","&#x1F517;","&#x1F519;","&#x1F51A;","&#x1F51B;","&#x1F51C;","&#x1F51D;","&#x1F51E;","&#x1F520;","&#x1F521;","&#x1F522;","&#x1F523;","&#x1F524;","&#x1F526;","&#x1F528;","&#x1F529;","&#x1F52A;","&#x1F52B;","&#x1F52C;","&#x1F52D;","&#x1F52E;","&#x1F531;","&#x1F532;","&#x1F533;","&#x1F534;","&#x1F535;","&#x1F536;","&#x1F537;","&#x1F538;","&#x1F539;","&#x1F53A;","&#x1F53B;","&#x1F53D;","&#x1F54B;","&#x1F54C;","&#x1F54D;","&#x1F54E;","&#x1F550;","&#x1F551;","&#x1F552;","&#x1F553;","&#x1F554;","&#x1F555;","&#x1F556;","&#x1F557;","&#x1F558;","&#x1F559;","&#x1F55A;","&#x1F55B;","&#x1F55C;","&#x1F55D;","&#x1F55E;","&#x1F55F;","&#x1F560;","&#x1F561;","&#x1F562;","&#x1F563;","&#x1F564;","&#x1F565;","&#x1F566;","&#x1F567;","&#x1F5FB;","&#x1F5FC;","&#x1F5FD;","&#x1F5FE;","&#x1F5FF;","&#x1F680;","&#x1F681;","&#x1F682;","&#x1F684;","&#x1F685;","&#x1F686;","&#x1F688;","&#x1F689;","&#x1F68A;","&#x1F68C;","&#x1F68D;","&#x1F68E;","&#x1F68F;","&#x1F690;","&#x1F691;","&#x1F692;","&#x1F693;","&#x1F694;","&#x1F695;","&#x1F696;","&#x1F697;","&#x1F698;","&#x1F69A;","&#x1F69B;","&#x1F69C;","&#x1F69D;","&#x1F69F;","&#x1F6A0;","&#x1F6A1;","&#x1F6A2;","&#x1F6A3;","&#x1F6A4;","&#x1F6A5;","&#x1F6A6;","&#x1F6A7;","&#x1F6A9;","&#x1F6AA;","&#x1F6AB;","&#x1F6AC;","&#x1F6AD;","&#x1F6AE;","&#x1F6AF;","&#x1F6B1;","&#x1F6B2;","&#x1F6B3;","&#x1F6B4;","&#x1F6B5;","&#x1F6B6;","&#x1F6B7;","&#x1F6B8;","&#x1F6B9;","&#x1F6BA;","&#x1F6BB;","&#x1F6BC;","&#x1F6BF;","&#x1F6C1;","&#x1F6C2;","&#x1F6C3;","&#x1F6C4;","&#x1F6C5;","&#x1F6D1;","&#x1F6EB;","&#x1F6EC;","&#x1F6F4;","&#x1F6F7;","&#x1F6F8;","&#x1F941;","&#x1F942;","&#x1F944;","&#x1F94A;","&#x1F94B;","&#x1F94C;","&#x1F94D;","&#x1F94F;","&#x1F950;","&#x1F951;","&#x1F952;","&#x1F953;","&#x1F954;","&#x1F955;","&#x1F956;","&#x1F957;","&#x1F959;","&#x1F95B;","&#x1F95C;","&#x1F95D;","&#x1F95E;","&#x1F960;","&#x1F961;","&#x1F963;","&#x1F965;","&#x1F966;","&#x1F967;","&#x1F968;","&#x1F969;","&#x1F96A;","&#x1F96B;","&#x1F96C;","&#x1F96D;","&#x1F96E;","&#x1F96F;","&#x1F97C;","&#x1F9C0;","&#x1F9C1;","&#x1F9C2;","&#x1F9E2;","&#x1F9E3;","&#x1F9E4;","&#x1F9E5;","&#x1F9E6;","&#x1F9E7;","&#x1F9E9;","&#x1F9EA;","&#x1F9EB;","&#x1F9EC;","&#x1F9ED;","&#x1F9EF;","&#x1F9F0;","&#x1F9F1;","&#x1F9F2;","&#x1F9F3;","&#x1F9F4;","&#x1F9F5;","&#x1F9F6;","&#x1F9F7;","&#x1F9F8;","&#x1F9F9;","&#x1F9FA;","&#x1F9FB;","&#x1F9FC;","&#x1F9FD;","&#x1F9FE;","&#x25FD;","&#x25FE;","&#x2614;","&#x23F9;","&#x23E9;","&#x23EA;","&#x23EB;","&#x23EC;","&#x23F0;","&#x231B;","&#x23F3;","&#x1F6D0;","&#128303;","&#x2648;","&#x2649;","&#x264A;","&#x264B;","&#x264C;","&#x264D;","&#x264E;","&#x264F;","&#x2650;","&#x2651;","&#x2652;","&#x2653;","&#x26CE;","&#x267F;","&#x2693;","&#x26A1;","&#x26AA;","&#x26AB;","&#x26C5;","&#x26D4;","&#x26EA;","&#x26F2;","&#x26F3;","&#x26F5;","&#x26FA;","&#x2753;","&#x2754;","&#x2755;","&#x2757;","&#x2795;","&#x2796;","&#x2797;","&#x27A1;","&#x27B0;","&#x27BF;","&#x2B1B;","&#x2B1C;","&#x2B50;","&#x2B55;"],u={component:"tab-component",link:"tab-link",item:"tab-item",selected:"selected",hidden:"hidden"};class it{constructor(t,e,i="beforeend"){o(this,"parent");o(this,"container");o(this,"linksWrap");o(this,"itemsWrap");o(this,"index");o(this,"links");o(this,"items");o(this,"onSelect");this.parent=e,this.container=document.createElement("div"),this.container.classList.add(u.component),this.linksWrap=document.createElement("div"),this.linksWrap.classList.add(`${u.link}-wrap`),this.itemsWrap=document.createElement("div"),this.itemsWrap.classList.add(`${u.item}-wrap`),this.index=0,this.links=[],this.items=[],t.forEach(n=>this._create(n)),this.parent.insertAdjacentElement(i,this.container),this.container.insertAdjacentElement("beforeend",this.linksWrap),this.container.insertAdjacentElement("beforeend",this.itemsWrap),this.links[this.index].classList.add(u.selected),this.items[this.index].classList.add(u.selected),this.container.setAttribute("style",`min-height: ${this.container.scrollHeight}px`),this.onSelect=null,this.linksWrap.addEventListener("click",this._onselect.bind(this))}_create(t){const e=this.links.length,i=document.createElement("div");i.classList.add(u.link,`${u.link}-${e}`),i.textContent=`${e+1}`,this.linksWrap.append(i),this.links.push(i);const n=document.createElement("div");n.classList.add(u.item,`${u.item}-${e}`),n.append(t),this.itemsWrap.append(n),this.items.push(n)}async _onselect(t){if(!t.target||!d(t.target,HTMLDivElement)||!this.links.includes(t.target))return;const e=this.links.indexOf(t.target);if(e<0||e>=this.links.length||e===this.index)return;const i=this.index;this.links[i].classList.remove(u.selected),this.links[e].classList.add(u.selected),this.items[i].classList.add(u.hidden),await E(250),this.index=e,this.items[i].classList.remove(u.selected),this.items[e].classList.add(u.hidden),this.items[e].classList.add(u.selected),this.items[e].classList.remove(u.hidden),this.onSelect&&this.onSelect(this.items[this.index],this.index)}}const st="button-component";class S{constructor(t,e,i){o(this,"parent");o(this,"elt");o(this,"click");o(this,"input");o(this,"label");this.elt=document.createElement("div"),this.elt.classList.add(st),this.parent=e??null,this.parent&&this.parent.insertAdjacentElement(i||"beforeend",this.elt);const n=document.createElement("input");n.id=t,n.name=t;const a=document.createElement("label");a.htmlFor=t,this.click=n.click.bind(n),this.input=n,this.label=a,this.elt.append(this.input,this.label)}disable(){this.input.setAttribute("disabled","disabled")}enable(){this.input.removeAttribute("disabled")}}const nt="radios-component";class ot{constructor(t,e,i){o(this,"parent");o(this,"elt");o(this,"buttons");o(this,"active");o(this,"values");o(this,"value");o(this,"onClick");this.elt=document.createElement("div"),this.elt.classList.add(nt),this.parent=e??null,this.parent&&this.parent.insertAdjacentElement(i||"beforeend",this.elt),this.buttons=[],this.active=null,this.values=t,this.value=null;for(const n of t){const a=new S(`radio-${n}`,this.elt);a.input.type="button",a.input.value=n,a.label.textContent=n,this.buttons.push(a)}this.onClick=null,this.elt.addEventListener("click",this._onclick.bind(this))}async _onclick(t){if(!d(t.target,HTMLInputElement))return;const e=this.buttons.reduce((i,n)=>n.input===t.target?n.input:i,null);e&&(this.enable(e.value),this.onClick&&await this.onClick(e.value))}enable(t){const e=`#radio-${t}`,i=this.elt.querySelector(e);i&&(this.buttons.filter(n=>n.input!==i).forEach(n=>n.input.removeAttribute("disabled")),this.active=i,this.active.setAttribute("disabled","disabled"),this.value=this.active.value)}disable(){for(const t of this.buttons)t.input.setAttribute("disabled","disabled");this.active=null,this.value=null}}const at="toggle-button";class rt extends S{constructor(e,i,n){const a=`toggle-${e.join("-")}`;super(a,i,n);o(this,"index");o(this,"values");o(this,"value");o(this,"onClick");this.elt.classList.add(at),this.index=0,this.values=e,this.value=e[this.index],this.label.innerText=this.value,this.onClick=null,this.input.type="button",this.input.value=this.value,this.input.addEventListener("click",this._onClick.bind(this))}set(e){const i=this.values.indexOf(e);i<0||i>=this.values.length||(this.index=i,this.value=e,this.input.value=this.value,this.label.innerText=this.value)}_onClick(e){e.target===this.input&&(this.index=(this.index+this.values.length+1)%this.values.length,this.value=this.values[this.index],this.input.value=this.value,this.label.innerText=this.value,this.onClick&&this.onClick(this.value))}}const lt="trigger-button";class I extends S{constructor(e,i,n,a){super(e,n,a);o(this,"onClick");this.elt.classList.add(lt),this.input.type="button",this.label.innerText=i,this.onClick=null,this.input.addEventListener("click",this._onClick.bind(this))}_onClick(){this.onClick&&this.onClick()}}const xt="color-picker";class ct extends S{constructor(e,i,n,a,x){super(e,a,x);o(this,"onChange");o(this,"value");this.elt.classList.add(xt),this.input.type="color",this.input.value=n,this.label.innerText=i,this.value=n,this.onChange=null,this.input.addEventListener("change",this._onChange.bind(this))}_onChange(){this.value=this.input.value,this.onChange&&this.onChange(this.value)}}const Ft="ul-component";class N{constructor(t,e){o(this,"parent");o(this,"elt");o(this,"items");this.elt=document.createElement("ul"),this.elt.classList.add(Ft),this.parent=t??null,this.parent&&this.parent.insertAdjacentElement(e||"beforeend",this.elt),this.items=[]}_getTargetItem(t){if(!t||!d(t,HTMLElement))return null;for(;!d(t,HTMLLIElement);)if(t=t.parentElement,!t||t===this.elt||!d(t,HTMLElement))return null;return t}createItem(...t){const e=document.createElement("li");return t.forEach(i=>{typeof i=="string"?e.insertAdjacentHTML("beforeend",i):e.insertAdjacentElement("beforeend",i)}),this.elt.append(e),this.items.push(e),e}}class ht extends N{constructor(e,i){super(e,i);o(this,"onClick");this.onClick=null,this.elt.addEventListener("click",this._onclick.bind(this))}async _onclick(e){const i=this._getTargetItem(e.target);i&&this.onClick&&await this.onClick(i)}}const g={removable:"removable",hidden:"hidden"};class U extends N{constructor(e,i){super(e,i);o(this,"onClick");o(this,"onRemove");this.onClick=null,this.onRemove=null,this.elt.addEventListener("click",this._onclick.bind(this))}async _onclick(e){const i=this._getTargetItem(e.target);if(i&&!(this.isRemovable()&&typeof this.onRemove=="function"&&await this.onRemove(i))){if(this.isRemovable()){this.removeListItem(i);return}this.onClick&&await this.onClick(i)}}isRemovable(){return this.elt.classList.contains(g.removable)}async toggleRemovable(){if(this.isRemovable()){this.items.forEach(e=>e.classList.remove(g.removable)),await E(300),this.elt.classList.remove(g.removable);return}this.elt.classList.add(g.removable),await E(100),this.items.forEach(e=>e.classList.add(g.removable))}createHiddenItem(...e){const i=this.createItem(...e);return i.classList.add(g.hidden),this.isRemovable()&&i.classList.add(g.removable),i}async showItem(e){return e.classList.remove(g.hidden),E(300)}async removeListItem(e){const i=this.items.indexOf(e);i<0||(this.items.splice(i,1),e.classList.add(g.hidden),await E(300),e.remove())}}const G={canvasWrap:"wrapper",controls:"sketch-controls",upload:"image-picker",emojis:"emoji-picker"},R=Object.keys(G).reduce((s,t)=>{const e=document.getElementById(G[t]);return O(e,HTMLDivElement),{...s,[t]:e}},{}),{canvasWrap:X}=R,Q=".inputs-wrap",C=R.controls.querySelector(Q);O(C,HTMLDivElement);const f=new rt(["play","pause"],C),A=new I("button-refresh","refresh",C),_=new ct("button-background","background","#101010",C),k=new I("button-shuffle","shuffle",C),W=new I("button-save","save",C),B=new U(C),P=R.upload.querySelector(Q);O(P,HTMLDivElement);const j=new I("button-upload","upload",P);j.input.type="file",j.input.setAttribute("multiple","multiple"),j.input.setAttribute("accept","image/png,image/jpeg");const D=new ot(["select","remove"],P),v=new U(P),K=dt(),ut=K.map(s=>s.elt);new it(ut,R.emojis);function dt(){const t=[];for(let e=0;e<L.length;e+=120){const i=new ht;for(let n=e;n<Math.min(e+120,L.length);n+=1)i.createItem(L[n]);t.push(i)}return t}class mt{constructor(){o(this,"img");o(this,"ctx");o(this,"cache");o(this,"textSize");o(this,"bufferSize");o(this,"bufferSizeHalf");this.img=new p5.Image(1,1),this.ctx=this.img.drawingContext,this.cache=new Map,this.textSize=0,this.bufferSize=0,this.bufferSizeHalf=0}_setBuffersize(t){const e=Array.from({length:5},(i,n)=>n+6).map(i=>2**i);this.bufferSize=e.find(i=>i>=t/3)||256,this.bufferSizeHalf=Math.floor(.5*this.bufferSize)}_setTextSize(){const t=1.4142135623730951*this.bufferSize;this.textSize=Math.floor(this.bufferSize*(this.bufferSize/t))}setup(t){this._setBuffersize(t),this._setTextSize(),this.img.resize(this.bufferSize,this.bufferSize),this.ctx.font=`${this.textSize}px serif`,this.ctx.textAlign="center",this.ctx.textBaseline="middle"}_createFromEmojiString(t){this.ctx.clearRect(0,0,this.bufferSize,this.bufferSize),this.ctx.fillText(t,this.bufferSizeHalf,this.bufferSizeHalf);const e=this._crop(this.img.get());return this.cache.set(t,e),e}_createFromImageBitmap(t,e){let i=e.width,n=e.height;if(i>this.bufferSize){const x=i/n;i/=x,n/=x}this.ctx.clearRect(0,0,this.bufferSize,this.bufferSize),this.ctx.drawImage(e,0,0,i,n),e.close();const a=this._crop(this.img.get());return this.cache.set(t,a),a}convertCoord2Index(t,e,i=this.bufferSize){return Math.floor(e*i+t)}convertIndex2Coord(t,e=this.bufferSize,i=e){return[t%e,t/i].map(n=>Math.floor(n))}isTransparentPixel(t,e,i,n=this.bufferSize){return t[4*this.convertCoord2Index(e,i,n)+3]===0}_crop(t){const{width:e,height:i}=t,n=4;let a,x,l,c;t.loadPixels();for(let r=0;r<i;r+=1){for(let F=0;F<e;F+=n)if(!this.isTransparentPixel(t.pixels,F,r,e)){x=r;break}if(x)break}for(let r=0;r<e;r+=1){for(let F=0;F<i;F+=n)if(!this.isTransparentPixel(t.pixels,r,F,e)){a=r;break}if(a)break}for(let r=i-1;r>=0;r-=1){for(let F=e-1;F>=0;F-=n)if(!this.isTransparentPixel(t.pixels,F,r,e)){c=r+1;break}if(c)break}for(let r=e-1;r>=0;r-=1){for(let F=i-1;F>=0;F-=n)if(!this.isTransparentPixel(t.pixels,r,F,e)){l=r+1;break}if(l)break}if(!a||!x||!l||!c)throw new Error("Something went wrong ...");return t.get(a,x,l-a,c-x)}get(t){var n,a;if(this.bufferSize===0)throw new Error("Renderer: setup is required");if(typeof t=="string")return((n=this.cache.get(t))==null?void 0:n.get())||this._createFromEmojiString(t);const[e,i]=t;return((a=this.cache.get(e))==null?void 0:a.get())||this._createFromImageBitmap(e,i)}getResizedDataUrl(t){const e=this.get(t);return e.width>e.height?e.resize(64,0):e.resize(0,64),e.canvas.toDataURL()}}const m=new mt,ft={setup(){pt(),D.onClick=function(s){v.toggleRemovable()},j.input.addEventListener("change",async function(){if(!this.files||this.files.length===0){console.warn("Nothing selected");return}const s=gt(this.files),t=(await Promise.allSettled(s)).filter(e=>e.status==="fulfilled").map(e=>e.value);for(const e of t){const i=m.get(e),n=e[0],a=i.canvas.toDataURL();localStorage.setItem(n,a),Y(n)}$()}),v.onRemove=async s=>{if(!confirm("Do you really want to remove this image?"))return!0;d(s.firstElementChild,HTMLImageElement)&&(s.classList.add("removing"),localStorage.removeItem(s.firstElementChild.alt),$())}},isEmpty(){return v.items.length===0}};async function pt(){for(let s=0;s<localStorage.length;s+=1){const t=localStorage.key(s),e=t&&localStorage.getItem(t);if(!e)continue;const i=await(await fetch(e)).blob(),n=await createImageBitmap(i);m.get([t,n]),Y(t)}$()}function gt(s){return Array.from(s).map(async t=>[p(t.name),await createImageBitmap(t,{resizeHeight:m.bufferSize})])}function Y(s){const t=new Image,e=v.createHiddenItem(t);t.onload=()=>{v.showItem(e)},t.alt=s,t.src=m.getResizedDataUrl(s)}function $(){if(v.items.length===0||localStorage.length===0){D.disable();return}if(v.isRemovable()){D.enable("remove");return}D.enable("select")}class bt{constructor(){o(this,"items");this.items=new Map}setup(){B.toggleRemovable(),B.onRemove=async t=>{t.classList.add("removing"),d(t.firstElementChild,HTMLImageElement)&&this.remove(t.firstElementChild.alt)},v.onClick=t=>{if(!d(t.firstElementChild,HTMLImageElement))return;const e=t.firstElementChild.alt;this.has(e)||this.add(e)},K.forEach(t=>{t.onClick=e=>{const i=e.innerText;this.has(i)||this.add(i)}})}isEmpty(){return this.items.size===0}has(t){for(const e of B.items)if(d(e.firstElementChild,HTMLImageElement)&&e.firstElementChild.alt===t)return!0;return!1}add(t){const e=m.get(t);this.items.set(t,e);const i=new Image,n=B.createHiddenItem(i);i.onload=()=>{B.showItem(n)},i.alt=t,i.src=m.getResizedDataUrl(t)}_pick(){const{length:t}=L,e=document.createElement("span"),i=[],n=Math.ceil(Math.random()*4);for(;i.length<n;){const a=L[Math.floor(Math.random()*t)];i.includes(a)||(e.innerHTML=a,i.push(e.innerText.trim()))}return i}async shuffle(){!k.input.disabled&&k.disable(),await this.clear(),this._pick().forEach(t=>this.add(t)),f.value==="play"&&k.enable()}pick(){const t=Math.floor(Math.random()*this.items.size);return[...this.items.values()][t]}async remove(t){this.items.delete(t)}async clear(){this.items.clear(),await B.items.reduce(async(t,e)=>(await t,e.click(),E(100)),Promise.resolve()),await E(200)}}const w=new bt;A.disable(),k.disable(),W.disable(),D.disable();const H={debugMode:!0,attempts:0,setup(s,t){vt(s),Et(s,t),Ct(s),kt(),wt(s)}};function vt(s){s.isLooping()?f.set("pause"):f.set("play"),J(),f.onClick=async t=>{t==="pause"&&w.isEmpty()&&await w.shuffle(),t==="pause"?s.loop():s.noLoop(),J()}}function Et(s,t){A.onClick=()=>{s.isLooping()||(H.attempts=0,s.background(_.value),t.clear(),f.enable(),f.click())}}function Ct(s){_.onChange=function(){s.isLooping()||s.redraw()}}function kt(){k.onClick=async function(){A.disable(),await w.shuffle(),A.enable()}}function wt(s){W.onClick=()=>{s.saveCanvas(`img-${Date.now()}`,"png")}}function J(){if(f.value==="play"){A.enable(),k.enable(),W.enable();return}A.disable(),k.disable(),W.disable()}function Z(s){if(!s)throw new Error("No Image")}class At{constructor(t,e,i,n){o(this,"buffer");o(this,"bufferWidthHalf");o(this,"bufferHeightHalf");o(this,"debug");o(this,"constrain");o(this,"img");o(this,"imgWidth");o(this,"imgHeight");o(this,"imgWidthHalf");o(this,"imgHeightHalf");o(this,"minScale");o(this,"scaleFactor");o(this,"scale");o(this,"maxAngle");o(this,"angle");o(this,"ax");o(this,"ay");o(this,"bx");o(this,"by");const{bufferSize:a}=m,x=t.createGraphics(a,a);x.pixelDensity(1),x.angleMode(t.RADIANS),x.imageMode(t.CENTER),this.buffer=x,this.bufferWidthHalf=Math.floor(.5*x.width),this.bufferHeightHalf=Math.floor(.5*x.height);const l=t.createGraphics(a,a);l.pixelDensity(1),l.angleMode(t.RADIANS),l.rectMode(t.CENTER),this.debug=l,this.constrain=t.constrain,this.img=void 0,this.imgWidth=0,this.imgHeight=0,this.imgWidthHalf=0,this.imgHeightHalf=0,this.ax=0,this.ay=0,this.bx=0,this.by=0,this.minScale=e,this.scaleFactor=i,this.scale=1,this.maxAngle=n,this.angle=0}setCurrentEmoji(t){if(this.img=w.pick(),this.scale=t<5?1:.625,this.angle=0,this.setRandomAngle(),this.calcAABB(),this.ax<0||this.ay<0){const e=Math.max(this.bx-this.ax,this.by-this.ay);this.scale=this.buffer.width/e,this.calcAABB()}this.drawToBuffer()}setRandomAngle(){this.angle=this.maxAngle*(Math.random()*2-1)*Math.PI}calcAABB(){Z(this.img),this.imgWidth=this.scale*this.img.width,this.imgWidthHalf=.5*this.imgWidth,this.imgHeight=this.scale*this.img.height,this.imgHeightHalf=.5*this.imgHeight;const t=Math.cos(this.angle),e=Math.sin(this.angle);let i=this.imgWidthHalf,n=this.imgHeightHalf,a=this.imgWidthHalf,x=-this.imgHeightHalf;const l=Math.abs(i*t-n*e),c=Math.abs(i*e+n*t),r=Math.abs(a*t-x*e),F=Math.abs(a*e+x*t),M=Math.max(l,r),y=Math.max(c,F);this.ax=this.bufferWidthHalf-M,this.ay=this.bufferHeightHalf-y,this.bx=this.bufferWidthHalf+M,this.by=this.bufferHeightHalf+y}drawToBuffer(){Z(this.img);const{buffer:t}=this;t.clear(),t.push(),t.translate(this.bufferWidthHalf,this.bufferHeightHalf),t.rotate(this.angle),t.image(this.img,0,0,this.imgWidth,this.imgHeight),t.pop(),t.loadPixels()}drawDebugBuffer(){const{debug:t}=this;t.clear(),t.noFill(),t.push(),t.translate(this.bufferWidthHalf,this.bufferHeightHalf),t.rectMode(t.CENTER),t.noStroke(),t.fill("#ffff0009"),t.rect(0,0,this.buffer.width,this.buffer.height),t.push(),t.rotate(this.angle),t.fill("#00ffff10"),t.rect(0,0,this.imgWidth,this.imgHeight),t.pop(),t.noFill(),t.stroke("#ffff00"),t.rect(0,0,this.imgWidth,this.imgHeight),t.pop(),t.rectMode(t.CORNERS),t.stroke("#00ffff"),t.rect(this.ax,this.ay,this.bx,this.by)}shrink(t=this.scaleFactor){if(this.scale-=t,this.scale<this.minScale){this.img=void 0;return}this.calcAABB(),this.drawToBuffer()}test(t,e,i,n){const[x,l,c,r]=[this.ax,this.ay,this.bx,this.by].map(T=>Math.floor(T));let F,M,y;for(let T=r-1;T>l;T-=4)for(let V=c-1;V>x;V-=4){const Mt=m.convertCoord2Index(V,T,this.buffer.width),q=this.buffer.pixels[4*Mt+3];F=i-this.bufferWidthHalf+V,M=n-this.bufferHeightHalf+T;const h=m.convertCoord2Index(F,M,e.width),z=e.pixels[4*h+3];if(y===void 0&&q!==0&&z!==0&&(y=!0),z===0&&q===0){t.pixels[4*h]=0,t.pixels[4*h+1]=0,t.pixels[4*h+2]=102,t.pixels[4*h+3]=255;continue}if(z===0&&q!==0){t.pixels[4*h]=51,t.pixels[4*h+1]=255,t.pixels[4*h+2]=51,t.pixels[4*h+3]=255;continue}if(z!==0&&q===0){t.pixels[4*h]=255,t.pixels[4*h+1]=255,t.pixels[4*h+2]=51,t.pixels[4*h+3]=255;continue}if(z!==0&&q!==0){t.pixels[4*h]=255,t.pixels[4*h+1]=0,t.pixels[4*h+2]=0,t.pixels[4*h+3]=255;continue}}return t.updatePixels(),y||!1}}const tt=500,Bt=20,yt=.25,Tt=1/6,Lt=.75,Dt=s=>{const t=Math.floor(Math.min(X.clientWidth,X.clientHeight));let e,i,n,a;s.setup=async function(){s.createCanvas(t,t),s.pixelDensity(1),s.background(_.value),s.rectMode(s.CENTER),s.noLoop(),s.frameRate(Bt),e=s.createGraphics(t,t),e.pixelDensity(1),i=s.createGraphics(t,t),i.pixelDensity(1),i.ellipseMode(s.CENTER),H.setup(s,e),m.setup(t),ft.setup(),w.setup(),await w.shuffle(),n=new Ht(t),a=new At(s,yt,Tt,Lt),f.click()},s.draw=function(){if(s.background(_.value),w.items.size===0)return;if(H.attempts===tt){s.image(e,0,0),a.img=void 0,f.click(),f.disable();return}s.noStroke(),s.fill(204),s.text(`Processing ... ${Math.round(100*H.attempts/tt)}%`,10,20),H.attempts+=1,e.loadPixels(),i.clear(),i.loadPixels(),a.img||(a.setCurrentEmoji(s.frameCount),n.setRandomCoords(a)),a.test(i,e,n.x,n.y)?a.shrink():(e.image(a.buffer,n.x-a.bufferWidthHalf,n.y-a.bufferHeightHalf,a.buffer.width,a.buffer.height),a.img=void 0),s.image(e,0,0),s.image(a.debug,n.x-a.bufferWidthHalf,n.y-a.bufferHeightHalf,a.buffer.width,a.buffer.height),s.image(i,0,0)}};class Ht{constructor(t){o(this,"canvasSize");o(this,"values");o(this,"x");o(this,"y");this.canvasSize=t,this.values=[],this.x=0,this.y=0}create(t){const[e,i]=[t.imgWidth,t.imgHeight].map(n=>Math.floor(n*.75));return[et(this.canvasSize-e,e),et(this.canvasSize-i,i)]}setRandomCoords(t){const e=this.create(t);this.values.push(e),this.x=e[0],this.y=e[1]}setDistributedCoords(t){const e=this.create(t),[i,n]=e.map(c=>Math.floor(c-m.bufferSizeHalf)),[a,x]=e.map(c=>Math.floor(c+m.bufferSizeHalf)),l=this.values.filter(([c,r])=>!(c<i||c>a||r<n||r>x));if(l.length<2)return e;if(l.length===2){const c=l[1][0]-l[0][0],r=l[1][1]-l[0][1];return[l[0][0]+.5*c,l[0][1]+.5*r].map(F=>Math.floor(F))}if(l.length>2)return[l.reduce((c,r)=>c+=r[0],0)/l.length,l.reduce((c,r)=>c+=r[1],0)/l.length].map(c=>Math.floor(c));throw new Error("Nope")}}function et(s=10,t=0){return t+Math.floor((s-t+1)*Math.random())}new window.p5(Dt,document.getElementById("wrapper"))})();
